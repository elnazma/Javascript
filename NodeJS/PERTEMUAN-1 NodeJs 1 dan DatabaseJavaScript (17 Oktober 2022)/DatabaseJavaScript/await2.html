<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Await</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
</head>
<body>
    <div class="container mt-3">
        <h1>Data Cuaca Daerah : <span id="name_city"></span></h1>
        <table class="table table-hover table-bordered table-striped">
            <thead>
                <th>No</th>
                <th>Date Time</th>
                <th>Weather</th>
                <th>Weather Desc</th>
                <th>Wind Speed</th>
                <th>Temperature</th>
                <th>Humidity</th>
                <th>Rain</th>
                <th>Clouds</th>
            </thead>
            <tbody id="myTBody">
            </tbody>
        </table>
    </div>


<script>

    function getProduct() {
        const request = new Request("https://api.openweathermap.org/data/2.5/forecast?lat=-7.7214217&lon=110.4138864&appid=ab0072a2ae28523c5680187db1669d43", {
            method: "GET"
        });

        const response = fetch(request);

        return response.then((response) => response.json());
    }

    async function getProductNameAsync() {
        // try {
            return await getProduct();
        // } catch (e) {
        //     return "Product Not Found";
        // } finally { }
    }


    getProductNameAsync()
        .then(function (data) {
            console.info(data);
            console.info(data.city);
            console.info(data.city.name);
            console.info(data.list);

            document.getElementById("name_city").textContent = data.city.name;

            let no        = 1;

            for (myValue of data.list) {
                console.info(myValue);
                const myTable      = document.getElementById("myTBody");
                if( typeof myValue.rain !== 'undefined' ){
                    var rain = Object.values(myValue.rain)[0];
                } else {
                    var rain = "no data";
                }
                myTable.innerHTML += `<tr>
                    <td>${no}</td>
                    <td>${myValue.dt_txt}</td>
                    <td>${myValue.weather[0].main}</td>
                    <td>${myValue.weather[0].description}</td>
                    <td>${myValue.wind.speed}</td>
                    <td>${myValue.main.temp}</td>
                    <td>${myValue.main.humidity}</td>
                    <td>${rain}</td>
                    <td>${myValue.clouds.all}</td>
                </tr>`;
                no++;
            }
        });

</script>
</body>
</html>
